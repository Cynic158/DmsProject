"use strict";(self["webpackChunkwyudmsdemo"]=self["webpackChunkwyudmsdemo"]||[]).push([[629],{3361:function(e,t,n){n.d(t,{BB:function(){return r},HF:function(){return f},Ho:function(){return d},I2:function(){return u},ci:function(){return p},eU:function(){return l},hD:function(){return v},lJ:function(){return m},oY:function(){return c},u8:function(){return i},x4:function(){return a},z$:function(){return g},zi:function(){return o}});var s=n(1547);function a(e){return(0,s.Z)({url:"/api/login",method:"post",data:e})}function u(e){return(0,s.Z)({url:"/api/forget",method:"post",data:e})}function l(e){return(0,s.Z)({url:"/api/reqemailcode",method:"get",params:e})}function o(e){return(0,s.Z)({url:"/api/getstuinfo",method:"post",data:e})}function r(e){return(0,s.Z)({url:"/api/getstubyid",method:"post",data:e})}function i(e){return(0,s.Z)({url:"/api/updatestuinfo",method:"post",data:e})}function d(e){return(0,s.Z)({url:"/api/deletestuinfo",method:"post",data:e})}function c(e){return(0,s.Z)({url:"/api/addstu",method:"post",data:e})}function m(e){return(0,s.Z)({url:"/api/expstu",method:"post",data:e})}function p(e){return(0,s.Z)({url:"/api/searchstu",method:"get",params:e})}function g(){return(0,s.Z)({url:"/api/gethomedata",method:"get"})}function v(e){return(0,s.Z)({url:"/api/updatephone",method:"post",data:e})}function f(e){return(0,s.Z)({url:"/api/updateemail",method:"post",data:e})}},8747:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var s=n(3396),a=n(9242),u=n(7139);function l(e,t,n,l,o,r){return(0,s.wg)(),(0,s.j4)(a.uT,{name:"t"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",{id:"toast"},(0,u.zw)(n.tmessage),513),[[a.F8,l.toastShow]])])),_:1})}var o=n(4870),r={name:"toast",props:{tmessage:{type:String,default:""}},setup(e,{emit:t}){const n=(0,o.iH)(!1);return(0,s.bv)((()=>{(0,s.YP)((()=>e.tmessage),(e=>{""!=e&&(n.value=!0,setTimeout((()=>{n.value=!1,setTimeout((()=>{t("update:tmessage","")}),1e3)}),2e3))}))})),{toastShow:n}}},i=n(89);const d=(0,i.Z)(r,[["render",l],["__scopeId","data-v-09d56c0f"]]);var c=d,m=n(4411);const p=e=>((0,s.dD)("data-v-059beafa"),e=e(),(0,s.Cn)(),e),g={class:"loginpage"},v={class:"signin"},f={class:"content"},w=p((()=>(0,s._)("h2",null,"登录",-1))),h={class:"form"},_={class:"input-box"},y=p((()=>(0,s._)("i",null,"用户名",-1))),b={class:"input-box"},k=p((()=>(0,s._)("i",null,"密码",-1))),Z={class:"links"},q={class:"input-box"},x={class:"signin"},H={class:"content"},U=p((()=>(0,s._)("h2",null,"忘记密码",-1))),j={class:"form"},C={class:"input-box"},D=p((()=>(0,s._)("i",null,"邮箱",-1))),S={class:"input-box"},N=p((()=>(0,s._)("i",null,"新密码",-1))),A={class:"input-box"},I=p((()=>(0,s._)("i",null,"验证码",-1))),T={class:"links"},z={key:1,href:"javascript:;"},V={class:"input-box"};function Y(e,t,n,l,o,r){const i=m.Z,d=c;return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("section",g,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(264,(e=>(0,s._)("span",{key:e,class:"bgbox"}))),64)),(0,s._)("div",v,[(0,s.Wm)(i,{class:"nightmode"}),(0,s._)("div",f,[w,(0,s._)("form",h,[(0,s._)("div",_,[(0,s.wy)((0,s._)("input",{type:"text",required:"","onUpdate:modelValue":t[0]||(t[0]=e=>l.dsname=e)},null,512),[[a.nr,l.dsname]]),y]),(0,s._)("div",b,[(0,s.wy)((0,s._)("input",{type:"password",required:"","onUpdate:modelValue":t[1]||(t[1]=e=>l.dspassword=e)},null,512),[[a.nr,l.dspassword]]),k]),(0,s._)("div",Z,[(0,s._)("a",{href:"javascript:;",onClick:t[2]||(t[2]=(...e)=>l.logincardturn&&l.logincardturn(...e))},"忘记密码")]),(0,s._)("div",q,[(0,s._)("input",{type:"submit",value:"登录",onClick:t[3]||(t[3]=(...e)=>l.dslogin&&l.dslogin(...e))})])])])]),(0,s._)("div",x,[(0,s.Wm)(i,{class:"nightmode"}),(0,s._)("div",H,[U,(0,s._)("form",j,[(0,s._)("div",C,[(0,s.wy)((0,s._)("input",{type:"text",required:"","onUpdate:modelValue":t[4]||(t[4]=e=>l.dsemail=e)},null,512),[[a.nr,l.dsemail]]),D]),(0,s._)("div",S,[(0,s.wy)((0,s._)("input",{type:"password",required:"","onUpdate:modelValue":t[5]||(t[5]=e=>l.dsnewpwd=e)},null,512),[[a.nr,l.dsnewpwd]]),N]),(0,s._)("div",A,[(0,s.wy)((0,s._)("input",{type:"text",required:"","onUpdate:modelValue":t[6]||(t[6]=e=>l.dsemailcode=e)},null,512),[[a.nr,l.dsemailcode]]),I]),(0,s._)("div",T,[(0,s._)("a",{href:"javascript:;",onClick:t[7]||(t[7]=(...e)=>l.forgetcardturn&&l.forgetcardturn(...e))},"返回登录"),30==l.countdown?((0,s.wg)(),(0,s.iD)("a",{key:0,href:"javascript:;",onClick:t[8]||(t[8]=(...e)=>l.requestcode&&l.requestcode(...e))},"发送验证码")):(0,s.kq)("",!0),30!=l.countdown?((0,s.wg)(),(0,s.iD)("a",z,(0,u.zw)(l.countdown),1)):(0,s.kq)("",!0)]),(0,s._)("div",V,[(0,s._)("input",{type:"submit",value:"验证",onClick:t[9]||(t[9]=(...e)=>l.dsforget&&l.dsforget(...e))})])])])])]),(0,s.Wm)(d,{tmessage:l.tmessage,"onUpdate:tmessage":t[10]||(t[10]=e=>l.tmessage=e)},null,8,["tmessage"])],64)}n(7658);var $=n(3361),W=n(65),B=n(2483),F=n(9702),J=n.n(F),K={name:"login",components:{Toast:c,Nightmode:m.Z},setup(){const e=(0,o.iH)(""),t=(0,o.iH)(""),n=(0,o.iH)(""),s=(0,o.iH)(""),a=(0,o.iH)(""),u=(0,o.iH)(30),l=(0,o.iH)(""),r=(0,W.oR)(),i=(0,B.tv)(),d=(0,B.yj)(),c=()=>{let e=null;e=setInterval((()=>{u.value--,u.value<0&&(clearInterval(e),u.value=30)}),1e3)},m=n=>{if(n.preventDefault(),""==e.value||""==t.value)l.value="用户名和密码不能为空";else{let n=J()(t.value);(0,$.x4)({dsname:e.value,dspassword:n}).then((e=>{0==e.status?(l.value=e.message,r.commit("dsuser/setUser",{id:e.id,dsuserName:e.dsuserName,token:e.token,type:e.type,job:e.job}),setTimeout((()=>{i.push(d.query.redirectUrl||"/")}),2e3)):(l.value=e.message,console.log(l.value))})).catch((e=>{l.value=e.message}))}},p=e=>{e.preventDefault();let t=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,u=/^[a-zA-Z]\w{5,17}$/;if(""==n.value||""==s.value||""==a.value)l.value="邮箱和验证码和新密码不能为空";else if(t.test(n.value))if(6!=s.value.length)l.value="验证码为六位数字";else if(u.test(a.value)){console.log("pass");let e=J()(a.value);(0,$.I2)({dsemail:n.value,dsemailcode:s.value,dspassword:e}).then((e=>{0==e.status?(l.value="修改密码成功，即将回转到登录",setTimeout((()=>{let e=document.querySelectorAll(".signin")[1];e.classList.contains("forgetturn")&&f()}),2e3)):l.value=e.message})).catch((e=>{l.value=e.message}))}else l.value="密码必须以字母开头，长度在6~18之间，只能包含字母、数字和下划线";else l.value="邮箱格式不正确"},g=()=>{let e=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;""==n.value?l.value="邮箱不能为空":e.test(n.value)?(console.log("sendcode"),(0,$.eU)({dsemail:n.value}).then((e=>{0==e.status&&c(),l.value=e.message})).catch((e=>{console.log(e.message)}))):l.value="邮箱格式不正确"},v=()=>{let e=document.querySelectorAll(".signin")[0],t=document.querySelectorAll(".signin")[1];e.className="signin loginturn",t.className="signin forgetturn"},f=()=>{let e=document.querySelectorAll(".signin")[0],t=document.querySelectorAll(".signin")[1];e.className="signin loginreturn",t.className="signin forgetreturn"};return{dsname:e,dspassword:t,dsemail:n,dsemailcode:s,dsnewpwd:a,dslogin:m,dsforget:p,tmessage:l,logincardturn:v,forgetcardturn:f,requestcode:g,countdown:u}}};const L=(0,i.Z)(K,[["render",Y],["__scopeId","data-v-059beafa"]]);var P=L}}]);
//# sourceMappingURL=629.5b313df3.js.map