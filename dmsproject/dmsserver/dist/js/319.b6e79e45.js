"use strict";(self["webpackChunkwyudmsdemo"]=self["webpackChunkwyudmsdemo"]||[]).push([[319],{4445:function(e,a,t){t.r(a),t.d(a,{default:function(){return D}});var l=t(3616),p=(t(2064),t(5478)),o=(t(6809),t(3417)),n=(t(172),t(7113),t(2354)),s=(t(3877),t(7960),t(1015)),i=(t(8474),t(3396)),r=t(9242),d=t(7139);const c={key:0,class:"appealformmask"},m={class:"appealformcontainer"},u={class:"appealformtitle"};function f(e,a,t,f,g,b){const h=(0,i.up)("CloseBold"),y=s.gn,w=n.BT,v=n.km,k=l.nH,C=o.EZ,_=p.mi,A=l.ly;return(0,i.wg)(),(0,i.j4)(r.uT,{name:"aform"},{default:(0,i.w5)((()=>[f.appealformshow?((0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("div",m,[(0,i._)("div",u,[(0,i.Uk)((0,d.zw)(f.appealtitle)+" ",1),(0,i.Wm)(y,{style:{position:"absolute",right:"5px",top:"5px","font-size":"26px",color:"var(--primary-green)",cursor:"pointer"}},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{onClick:f.appealformhide},null,8,["onClick"])])),_:1})]),(0,i.Wm)(A,{inline:!0,model:f.appealeditobj,class:"appealform"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{label:"类型",style:{width:"30%"}},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{modelValue:f.appealeditobj.type,"onUpdate:modelValue":a[0]||(a[0]=e=>f.appealeditobj.type=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{label:"建议",value:"建议"}),(0,i.Wm)(w,{label:"投诉",value:"投诉"})])),_:1},8,["modelValue"])])),_:1}),(0,i.Wm)(k,{label:"正文",style:{width:"98%"}},{default:(0,i.w5)((()=>[(0,i.Wm)(C,{class:"contentrequired",modelValue:f.appealeditobj.content,"onUpdate:modelValue":a[1]||(a[1]=e=>f.appealeditobj.content=e),type:"textarea",placeholder:"输入正文",resize:"none",rows:"8"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(k,{style:{"margin-right":"8px",float:"right"}},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{type:"primary",onClick:f.onappealSubmit,style:{"font-weight":"700","font-size":"16px"}},{default:(0,i.w5)((()=>[(0,i.Uk)("确定")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])])):(0,i.kq)("",!0)])),_:1})}var g=t(2748),b=t(4870),h=t(65),y=t(6337),w={name:"stuformappeal",components:{CloseBold:g.q6s},setup(e,{emit:a}){const t=(0,h.oR)(),l=(0,b.iH)(!1),p=(0,b.iH)("更改诉求"),o=()=>{l.value=!1},n=(0,b.qj)({id:0,type:"建议",content:""}),s=()=>{""==n.type.trim()||""==n.content.trim()?t.commit("setNoticeContent","正文不能为空"):0==t.state.dsappeal.appealformtype?(0,y.NC)({type:n.type,content:n.content,stuid:t.state.dsuser.dsuserInfo.id}).then((e=>{0==e.status?(t.commit("setNoticeContent",e.message),a("settable"),l.value=!1):t.commit("setNoticeContent",e.message)})).catch((e=>{console.log(e.message)})):1==t.state.dsappeal.appealformtype&&(0,y.Fr)(n).then((e=>{0==e.status?(t.commit("setNoticeContent",e.message),a("settable"),l.value=!1):t.commit("setNoticeContent",e.message)})).catch((e=>{console.log(e.message)}))};return(0,i.bv)((()=>{(0,i.YP)((()=>t.state.dsappeal.appealformstatus),(()=>{0==t.state.dsappeal.appealformtype?(p.value="发布诉求",n.content="",n.type="建议",l.value=!0):1==t.state.dsappeal.appealformtype&&(p.value="更改诉求",(0,y.km)({id:t.state.dsappeal.appealformid}).then((e=>{0==e.status?(n.id=e.appealinfo[0].id,n.type=e.appealinfo[0].type,n.content=e.appealinfo[0].content,l.value=!0):console.log(e.message)})).catch((e=>{console.log(e.message)})))}))})),{appealformshow:l,appealtitle:p,appealformhide:o,appealeditobj:n,onappealSubmit:s}}},v=t(89);const k=(0,v.Z)(w,[["render",f]]);var C=k,_=t(2651),A=t(7951),W=(t(3069),t(4923));t(6905),t(9007);const x={style:{position:"relative"}},S={class:"appealContainer"},j={class:"appealTitle"},z={class:"appealFoot"},H={class:"appealTime"},q={class:"appealMan"},U={class:"elpageAppeal"};function T(e,a,t,l,o,n){const s=W.$Y,c=p.mi,m=W.eI,u=A.R,f=_.Z,g=C;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",x,[(0,i._)("div",S,[(0,i._)("p",j,(0,d.zw)(l.appealinfo.info[0].type),1),(0,i.wy)((0,i._)("textarea",{class:"appealContent",readonly:"","onUpdate:modelValue":a[0]||(a[0]=e=>l.appealinfo.info[0].content=e)},null,512),[[r.nr,l.appealinfo.info[0].content]]),(0,i._)("p",z,[(0,i._)("span",H,"时间: "+(0,d.zw)(l.appealinfo.info[0].time),1),(0,i._)("span",q,"学生: "+(0,d.zw)(l.appealinfo.info[0].appealstu),1)])]),(0,i.Wm)(m,{class:"appealtable",data:l.appeallist.list,onRowClick:l.rowclick,style:{width:"calc(100% - 430px)","margin-bottom":"18px",display:"inline-block",position:"absolute",left:"430px",top:"20px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(s,{align:"center",label:"时间",prop:"time",width:"200"}),(0,i.Wm)(s,{align:"center",label:"类型",prop:"type",width:"60"}),(0,i.Wm)(s,{align:"center",label:"学生",prop:"appealstu",width:"100"}),(0,i.Wm)(s,{align:"center",label:"学号",prop:"stunumber"}),(0,i.Wm)(s,{align:"center",label:"手机",prop:"phone"}),(0,i.Wm)(s,{align:"center",label:"楼栋",prop:"building",width:"60"}),(0,i.Wm)(s,{align:"center",label:"房间",prop:"room",width:"60"}),(0,i.Wm)(s,{align:"center",prop:"id",width:"180"},{header:(0,i.w5)((()=>[(0,i.Uk)(" 操作 ")])),default:(0,i.w5)((e=>[(0,i.Wm)(c,{style:{color:"var(--text-gray-black)","font-weight":"700",width:"auto"},size:"small",type:"primary",onClick:a=>l.handleAppealEdit(e.$index,e.row)},{default:(0,i.w5)((()=>[(0,i.Uk)("更改")])),_:2},1032,["onClick"]),(0,i.Wm)(c,{style:{color:"var(--text-gray-black)","font-weight":"700"},size:"small",type:"danger",onClick:a=>l.handleAppealDelete(e.$index,e.row)},{default:(0,i.w5)((()=>[(0,i.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onRowClick"]),(0,i._)("button",{class:"clearAppeal",onClick:a[1]||(a[1]=(...e)=>l.sendappeal&&l.sendappeal(...e))},"发布诉求"),(0,i._)("div",U,[(0,i.Wm)(u,{"current-page":l.currentAppealPage,"onUpdate:currentPage":a[2]||(a[2]=e=>l.currentAppealPage=e),"page-size":12,disabled:l.appealPageDisabled,background:"",layout:"total, prev, pager, next, jumper",total:l.appealtotal,onCurrentChange:l.handleAppealCurrentChange},null,8,["current-page","disabled","total","onCurrentChange"])])]),(0,i.Wm)(f,{style:{"z-index":"99"},handleId:l.deleteid,"onUpdate:handleId":a[3]||(a[3]=e=>l.deleteid=e),confirmStr:l.deletestr,onSettable:l.settable,handleType:l.deletetype},null,8,["handleId","confirmStr","onSettable","handleType"]),(0,i.Wm)(g,{onSettable:l.settable},null,8,["onSettable"])],64)}var E={name:"stuappeal",components:{Dmsconfirm:_.Z,Stuformappeal:C},setup(){let e=(0,b.qj)({list:[{id:1,time:"2023-02-17 23:26",type:"建议",appealstu:"方文轩",stunumber:"3119001333",phone:"13356580997",building:"48",room:"202"}]}),a=(0,b.qj)({info:[{type:"类型",content:"正文",time:"2023-03-01 17:16",appealstu:"学生一"}]});const t=(0,h.oR)(),l=()=>{p(1),o(0)},p=a=>{(0,y.$H)({page:a,stuid:t.state.dsuser.dsuserInfo.id}).then((a=>{0==a.status?(e.list=a.appeallist,u.value=Object.values(a.appealcount[0])[0],w()):console.log(a.message)})).catch((e=>{console.log(e.message)}))},o=e=>{(0,y.sw)({id:e,stuid:t.state.dsuser.dsuserInfo.id}).then((e=>{0==e.status?0==e.appealinfo.length?a.info=[{type:"类型",content:"正文",time:"2023-03-01 17:16",appealstu:"学生一"}]:(a.info=e.appealinfo,t.commit("dsappeal/setActiveAppealpage",m.value)):console.log(e.message)})).catch((e=>{console.log(e.message)}))},n=(0,b.iH)(0),s=(0,b.iH)("确定要删除该诉求吗"),r=(0,b.iH)(13),d=(e,a)=>{n.value=a.id,s.value="确定要删除该诉求吗",r.value=13},c=(e,a)=>{t.commit("dsappeal/setAppealFormId",a.id),t.commit("dsappeal/setAppealFormType",1),t.commit("dsappeal/setAppealFormStatus")},m=(0,b.iH)(1),u=(0,b.iH)(100),f=(0,b.iH)(!1),g=e=>{p(e)},w=()=>{setTimeout((()=>{let e=0;document.querySelectorAll(".appealtable .el-table__row").forEach((a=>{a.getAttribute("index")||a.addEventListener("click",(function(){t.commit("dsappeal/setActiveAppeal",a.getAttribute("index")),document.querySelectorAll(".appealtable .el-table__row").forEach((e=>{e.classList.remove("activeappealcolor")})),a.classList.add("activeappealcolor")})),a.setAttribute("index",e),e++})),t.state.dsappeal.activeappealpage==m.value?document.querySelectorAll(".appealtable .el-table__row").forEach((e=>{e.getAttribute("index")==t.state.dsappeal.activeappeal&&e.classList.add("activeappealcolor")})):document.querySelectorAll(".appealtable .el-table__row").forEach((e=>{e.classList.remove("activeappealcolor")}))}),500)},v=function(e){o(e.id)},k=()=>{t.commit("dsappeal/setAppealFormType",0),t.commit("dsappeal/setAppealFormStatus")};return(0,i.bv)((()=>{p(1),o(0)})),{appeallist:e,handleAppealDelete:d,handleAppealEdit:c,currentAppealPage:m,appealtotal:u,appealPageDisabled:f,handleAppealCurrentChange:g,rowclick:v,appealinfo:a,sendappeal:k,deleteid:n,setappealtable:p,deletetype:r,deletestr:s,settable:l}}};const I=(0,v.Z)(E,[["render",T]]);var D=I}}]);
//# sourceMappingURL=319.b6e79e45.js.map